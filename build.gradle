buildscript {
  repositories {
    mavenCentral()
  }
  dependencies {
  }
}

plugins {
  id 'org.openapi.generator' version '5.0.1'
  id 'java'
  id 'maven-publish'
  id 'net.researchgate.release' version '2.8.1'
}

project.ext {
  name = 'Passende FinanzierungsVorschl√§ge API'
  artifactId = 'baufi-passende-vorschlaege-api'
  groupId = 'de.europace'
  version = "${version}"
}

group = 'de.europace'

repositories {
  mavenCentral()
}

publishing {
  publications {
    mavenJava(MavenPublication) {
      version = "${property("version")}".toString()
      artifact "$rootDir/baufi-passende-vorschlaege-api.yaml"
    }
  }

  repositories {
    maven {
      url.set 's3://api-infrastructure-yaml-descriptor'
      authentication {
        awsIm(AwsImAuthentication)
      }
    }
  }
}

openApiValidate {
  inputSpec.set "$rootDir/${property("baufi.passende.vorschlaege.api.file.name")}"
  recommend.set true
}

openApiGenerate {
  generatorName.set 'javascript'
  inputSpec.set 'baufi-passende-vorschlaege-api.yaml'
  outputDir.set "$buildDir/generated".toString()
  apiPackage.set 'de.europace.baufi.passende.vorschlaege.api'
  modelPackage.set 'de.hypoport.ep2.baufismart.passende.vorschlaege.model'
}

release {
  failOnCommitNeeded = false
}

publish.dependsOn tasks.openApiValidate

afterReleaseBuild.dependsOn publish
